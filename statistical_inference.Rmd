---
title: "Data Science Statistical Inference"
author: "Ben Kooi"
date: "28-7-2021"
output: html_document
---
## Synopsis
This report describes a simulation of a exponential distribution and the analysis of the TootGrowth-dataset.
The questions that should be answered are:

1. Exponential Distribution Simulation
    * Show the sample mean and compare it to the theoretical mean of the distribution
    * Show how variable the sample is (via variance) and compare it to the theoretical variance of the distribution
    * Show that the distribution is approximately normal
2. Analyzing Toothgrowth Dataset
    * Provide a basic summary of the data
    * Use confidence intervals and/or hypothesis tests to compare tooth growth by supp and dose
    * Conclusions and assumptions
    
The sample mean, the mean of sampling the exponential distribution a 1000 times with a sample size of 40 is nearly the same as theoretical mean of the exponential distribution. This also proves the Central Limit Theorem. Also the variance of the sample and the theoretical variance are nearly the same.

The most important conclusion of analyzing the ToothGrowth-dataset is that we can reject the null-hypothesis for len ~ dose, but for len ~ supp we can accept the null-hypothesis. In other words, dose matters by tootgrowth and supp not.
 
## Setting the environment

Load the needed packages.
```{r}
packages <- c("data.table","dplyr", "ggplot2")
sapply(packages, require, character.only=TRUE, quietly=TRUE)
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Part 1 - Exponential Distribution Simulation

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r }
set.seed(5)
observations<-1000
samplesize<-40
rate<-0.2
theoretical_mean<-1/rate
theoretical_sd<-1/rate
theoretical_var<- 1 / (rate^2)
exponentialdistribution<-rexp(observations,rate)
hist(exponentialdistribution)
summary(exponentialdistribution)
str(exponentialdistribution)
mean(exponentialdistribution)
var(exponentialdistribution)
sd(exponentialdistribution)
samplemeans = NULL
for (i in 1 : 1000) samplemeans = c(samplemeans, mean(sample(exponentialdistribution, samplesize, replace=TRUE)))

summary(samplemeans)
str(samplemeans)
hist(samplemeans)
var(samplemeans)
sd(samplemeans)
theoretical_mean
theoretical_sd
theoretical_var
```
The variance of X is given by
X = 1 / lambda^2



## Part 2 - Analyzing Toothgrowth Dataset

You can also embed plots, for example:

```{r toothgrowth}
ToothGrowth$dose <- as.factor(ToothGrowth$dose)
summary(ToothGrowth)
str(ToothGrowth)
# Change box plot colors by groups
p<-ggplot(ToothGrowth, aes(x=dose, y=len, fill=dose)) +
  geom_boxplot()
p
t.test(len ~ dose, paired = FALSE, data = subset(ToothGrowth,(ToothGrowth$dose %in% c(0.5, 1))))
t.test(len ~ dose, paired = FALSE, data = subset(ToothGrowth,(ToothGrowth$dose %in% c(0.5, 2))))
t.test(len ~ dose, paired = FALSE, data = subset(ToothGrowth,(ToothGrowth$dose %in% c(1, 2))))
# Change the position
t<-ggplot(ToothGrowth, aes(x=supp, y=len, fill=supp)) +
  geom_boxplot()
t
t.test(len ~ supp, paired = FALSE, data = ToothGrowth)
n<-ggplot(data = ToothGrowth, aes(x = len,  colour="red", fill = "red", alpha=0.1)) + theme(legend.position="none") + geom_density() +  geom_vline(xintercept = median(ToothGrowth$len), size = .75, color = "blue")
n
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
